#include <iostream>
using namespace std;

#include "RSADecrypt.h"
#include "RSAEncrypt.h"

int main()
{

mpz_class privateKey, publicKey, N;
/*privateKey = "114984664399337953520558255203141192333805172345118423913119974155264846268358147474521807450124024416577176404421833728775067339210837344986803843641099626673116863775554297296439318025585418320073007261290141781452732710489853223804369001455491669214358109562950771259428071368840359983482438105099409151053";

publicKey = "196591806358810403066000000571844784532053969118652901375651409930014502893145897132892614915754546214287989125678704174952574907032346327940829056789421002139660662000340562199974356189728346022059669367305299487973829096710386014240896870263749744857018624149229164370257042331366121344551193388119807818413";

N = "11106576437893651914429971950296766545218328234966405150004099534831280656220352902115256969200226837100615072371678293324718066662219356428433942929961927930508246818576071036492266660964304156455800952530628255697323985856981931590878824914826820903640382073611640001006177923787094824523835465768648146281571343815763950792548395396129961584013492937059473381089026407449142168763382477951099674153307978720924092145569913523268673008695890015659702386404316772254317496396801975031170104468426555962442898422977191406948746342390265373110980946985913983171624566669452075183342449469082405869368658446948311738889";
*/
privateKey = mpz_class("00808b02fa074770032d36a116e94f957745edad2df5851238824ad6b5ae3f54ca47c120af21324ceb3f63b3b2ba825b1664ddf98b0b841a79c47b89c5479c1c9415ded3bb0e12a6e2ae7635534ca1bed7e0e6e5029ada20211cd1787bf0241eb0082b23d525b56a8392cbbefbc3cfc81299d03fc7aa9a42dd45aaa739da2b3561", 16);
publicKey = 65537;
N = mpz_class("00c22be5a4820e5e96c6fff45f8e2e8f4810bd4e9ac6589fd1ac11302fccc40e8c636e9d1edeee1c3cbae0068d57a10ee8bd68ad7b388eafb47799765578a67775486cfd836e4a17ae9128a8b37836a5096547e4ee98ab3977e079133ba1c9e7c1069160b6bc9979ff13e70165e927264948c790f85139096c4906a1650de7839b", 16);

RSAEncrypt encryptEngine = RSAEncrypt(publicKey, N );
RSADecrypt decryptEngine = RSADecrypt(privateKey, N );

mpz_class msg, msg1, msg2;
msg  = "1234";
cout<<"Msg is : "<<msg<<endl;
msg1 = encryptEngine.encrypt(msg);

cout<<"Msg1 is : "<<msg1<<endl;

msg2 = decryptEngine.decrypt(msg1);
cout<<"Msg2 is : "<<msg2<<endl;

cout<<msg<<" \n"<<msg1<<" \n"<<msg2<<endl;
return 0;
}
